<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Arti // Federal Career Pathfinder</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
<style>
/* ==========================================================================
   NEO-BRUTALIST TOKENS
   ========================================================================== */
:root {
    --ink: #1a1a2e;        
    --paper: #ffffff;      
    --cream: #f8f6f1;      
    
    /* Palette */
    --pale-blue: #c8dae8;  
    --soft-blue: #93b5d9;  
    --deep-blue: #4a6a8a;  

    /* Signals */
    --mint: #d4e8dc;
    --clay: #e07a5f;
    --gold: #f2cc8f;
    
    /* The "Chunky" Look */
    --border: 3px solid var(--ink);
    --shadow: 5px 5px 0 var(--ink);
    --shadow-sm: 3px 3px 0 var(--ink);
    --radius: 12px;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body { 
    margin: 0; padding: 0; 
    font-family: 'DM Sans', sans-serif; 
    background: var(--pale-blue); 
    color: var(--ink);
    height: 100vh; overflow: hidden;
}

h1, h2, h3, .mono { font-family: 'Space Mono', monospace; }

/* ==========================================================================
   APP FRAME
   ========================================================================== */
.app-frame {
    max-width: 600px; 
    margin: 0 auto; 
    height: 100vh;
    background: var(--cream); 
    border-left: var(--border); 
    border-right: var(--border);
    display: flex; 
    flex-direction: column; 
    position: relative;
    box-shadow: 0 0 50px rgba(0,0,0,0.1);
}

@media(max-width: 650px) { 
    .app-frame { border: none; width: 100%; } 
}

/* HEADER */
.app-header {
    padding: 18px 24px; 
    border-bottom: var(--border); 
    background: var(--paper);
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    z-index: 10;
}

.brand { 
    font-family: 'Space Mono'; 
    font-weight: 700; 
    font-size: 16px; 
    display: flex; 
    align-items: center; 
    gap: 12px; 
    text-transform: uppercase;
    letter-spacing: -0.5px;
}

/* Clean Avatar */
.brand-avatar { 
    width: 40px; 
    height: 40px; 
    display: flex;
    align-items: center;
    justify-content: center;
}
.brand-avatar img { width: 100%; height: 100%; object-fit: contain; }

/* ==========================================================================
   VIEWS & CARDS
   ========================================================================== */
.view-container { 
    flex: 1; 
    overflow-y: auto; 
    padding: 24px; 
    display: none; 
    background: var(--cream);
    padding-bottom: 100px; /* Space for Chat FAB */
}
.view-container.active { display: block; }

/* Typography */
.hero-title { 
    font-family: 'Space Mono'; 
    font-size: 24px; 
    font-weight: 700; 
    line-height: 1.2; 
    margin-bottom: 12px; 
    text-transform: uppercase;
}
.hero-sub { 
    font-size: 15px; 
    opacity: 0.8; 
    margin-bottom: 32px; 
    max-width: 90%;
    line-height: 1.5;
}

/* Chunky Cards */
.quiz-card {
    background: var(--paper); 
    border: var(--border); 
    border-radius: var(--radius);
    padding: 24px; 
    box-shadow: var(--shadow); 
    margin-bottom: 24px;
}

.quiz-question { 
    font-family: 'Space Mono'; 
    font-weight: 700; 
    font-size: 13px; 
    margin-bottom: 20px; 
    text-transform: uppercase; 
    border-bottom: 2px solid #eee;
    padding-bottom: 12px;
}

/* Options */
.quiz-options { display: flex; flex-direction: column; gap: 12px; }

.option-btn {
    padding: 16px 20px; 
    text-align: left;
    background: var(--paper); 
    border: 2px solid var(--ink); 
    border-radius: 8px;
    font-family: 'Space Mono'; 
    font-weight: 700; 
    font-size: 13px; 
    cursor: pointer;
    transition: all 0.1s;
    box-shadow: var(--shadow-sm);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.option-btn:hover { 
    background: var(--pale-blue); 
    transform: translate(-2px, -2px); 
    box-shadow: 5px 5px 0 var(--ink); 
}
.option-btn:active {
    transform: translate(2px, 2px);
    box-shadow: 1px 1px 0 var(--ink);
}

/* ARCHETYPE RESULT */
.archetype-card {
    background: var(--paper); 
    border: var(--border); 
    border-radius: var(--radius);
    padding: 0; 
    overflow: hidden; 
    box-shadow: var(--shadow); 
    margin-bottom: 24px;
    text-align: center;
}

.arch-header { 
    padding: 40px 20px; 
    background: var(--pale-blue);
    border-bottom: var(--border); 
}

.arch-icon { font-size: 64px; margin-bottom: 16px; display: block; filter: drop-shadow(4px 4px 0 rgba(0,0,0,0.2)); }

.arch-name { 
    font-family: 'Space Mono'; 
    font-weight: 700; 
    font-size: 22px; 
    text-transform: uppercase; 
    display: block; 
    letter-spacing: -0.5px;
    background: var(--paper);
    border: 2px solid var(--ink);
    display: inline-block;
    padding: 8px 16px;
    border-radius: 50px;
    box-shadow: 3px 3px 0 rgba(0,0,0,0.1);
}

.arch-body { padding: 24px; text-align: left; }
.arch-desc { font-size: 14px; margin-bottom: 24px; line-height: 1.6; }

/* Job Links */
.job-link-btn {
    display: flex; align-items: center; justify-content: space-between;
    padding: 16px; margin-bottom: 12px;
    background: var(--paper); 
    border: 2px solid var(--ink); 
    border-radius: 8px;
    text-decoration: none; 
    color: var(--ink); 
    font-family: 'Space Mono';
    font-weight: 700; font-size: 12px;
    box-shadow: 3px 3px 0 rgba(0,0,0,0.1); 
    transition: all 0.1s;
}
.job-link-btn:hover { 
    transform: translate(-2px, -2px); 
    box-shadow: 4px 4px 0 var(--ink); 
    background: var(--mint); 
}

/* ANALYZER INPUTS */
.form-group { margin-bottom: 20px; }
.label { 
    font-family: 'Space Mono'; font-size: 11px; font-weight: 700; 
    text-transform: uppercase; margin-bottom: 8px; display: block; 
}

textarea.chunky-input {
    width: 100%; height: 140px; padding: 16px; 
    border: var(--border); border-radius: 8px;
    font-family: 'DM Sans'; font-size: 14px; resize: none; 
    background: var(--paper);
    box-shadow: 4px 4px 0 rgba(0,0,0,0.05);
}
textarea.chunky-input:focus {
    outline: none;
    box-shadow: var(--shadow-sm);
    background: #fff;
}

/* Primary Button */
.btn-main {
    width: 100%; padding: 18px; 
    background: var(--ink); color: white;
    font-family: 'Space Mono'; font-weight: 700; font-size: 14px;
    text-transform: uppercase;
    border: none; border-radius: 8px;
    cursor: pointer; display: flex; justify-content: space-between;
    box-shadow: var(--shadow-sm);
    transition: all 0.1s;
}
.btn-main:active { transform: translate(2px, 2px); box-shadow: none; }

/* Secondary Button (Retake Quiz) */
.btn-secondary {
    width: 100%; padding: 14px;
    background: var(--paper); color: var(--ink);
    font-family: 'Space Mono'; font-weight: 700; font-size: 12px;
    text-transform: uppercase;
    border: 2px solid var(--ink); border-radius: 8px;
    cursor: pointer; text-align: center;
    box-shadow: 3px 3px 0 rgba(0,0,0,0.1);
    transition: all 0.1s;
}
.btn-secondary:hover {
    box-shadow: 4px 4px 0 var(--ink);
    background: #f4f4f4;
}
.btn-secondary:active { transform: translate(2px, 2px); box-shadow: none; }

/* ==========================================================================
   FLOATING CHAT (The "Expert" Widget)
   ========================================================================== */
.fab-chat {
    position: fixed; bottom: 85px; right: 24px;
    width: 56px; height: 56px;
    background: var(--ink);
    border-radius: 50%;
    box-shadow: 4px 4px 0 rgba(0,0,0,0.3);
    cursor: pointer; display: grid; place-items: center; z-index: 900;
    transition: transform 0.2s;
}
.fab-chat:hover { transform: scale(1.1); }
.fab-chat svg { width: 28px; height: 28px; fill: white; }

.chat-overlay {
    position: fixed; bottom: 150px; right: 24px;
    width: 340px; height: 450px;
    background: var(--paper);
    border: var(--border); border-radius: var(--radius);
    box-shadow: 8px 8px 0 rgba(0,0,0,0.5);
    display: flex; flex-direction: column;
    z-index: 999;
    transform: translateY(20px); opacity: 0; pointer-events: none;
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
.chat-overlay.open { transform: translateY(0); opacity: 1; pointer-events: all; }
@media(max-width: 480px) {
    .chat-overlay { width: auto; left: 10px; right: 10px; bottom: 150px; }
}

.chat-header {
    padding: 14px; border-bottom: var(--border); background: var(--gold);
    border-radius: 9px 9px 0 0; display: flex; justify-content: space-between; align-items: center;
}
.chat-messages {
    flex: 1; overflow-y: auto; padding: 14px; display: flex; flex-direction: column; gap: 10px;
}
.chat-input-row {
    padding: 10px; border-top: var(--border); background: #fff; display: flex; gap: 8px; border-radius: 0 0 9px 9px;
}
.chat-input {
    flex: 1; border: 2px solid var(--ink); border-radius: 6px; padding: 10px; font-family: 'DM Sans'; font-size: 13px;
}

/* Bubbles */
.msg { max-width: 85%; padding: 10px 12px; border-radius: 10px; font-size: 13px; line-height: 1.4; border: 2px solid var(--ink); }
.msg.arti { background: #fff; align-self: flex-start; border-top-left-radius: 2px; box-shadow: 2px 2px 0 rgba(0,0,0,0.1); }
.msg.user { background: var(--ink); color: white; align-self: flex-end; border-top-right-radius: 2px; }

/* ==========================================================================
   BOTTOM NAV
   ========================================================================== */
.bottom-nav {
    border-top: var(--border); 
    background: var(--paper); 
    padding: 16px;
    display: flex; gap: 16px;
    position: fixed; bottom: 0; left: 0; right: 0;
    max-width: 600px; margin: 0 auto;
    z-index: 1000;
}

.nav-item {
    flex: 1; padding: 14px; text-align: center;
    font-family: 'Space Mono'; font-size: 12px; font-weight: 700; text-transform: uppercase;
    border: 2px solid transparent; border-radius: 8px; cursor: pointer; opacity: 0.6;
    transition: all 0.2s;
}
.nav-item:hover { opacity: 1; background: #f4f4f4; }
.nav-item.active { 
    opacity: 1; 
    border: 2px solid var(--ink); 
    background: var(--pale-blue); 
    box-shadow: 3px 3px 0 var(--ink);
}

</style>
</head>
<body>

<div class="app-frame">
    <header class="app-header">
        <div class="brand">
            <div class="brand-avatar"><img src="arti.png" alt="Arti"></div>
            <div>Arti // Fed Sales Bot</div>
        </div>
        <div style="width:10px; height:10px; background:#00ff00; border:1px solid black; border-radius:50%; box-shadow:1px 1px 0 black;"></div>
    </header>

    <div id="viewPathfinder" class="view-container active">
        <div id="quizIntro">
            <div class="hero-title">Where do you fit?</div>
            <div class="hero-sub">I'll help you find your ideal role in the Defense Industrial Base in 3 steps.</div>
            
            <div class="quiz-card">
                <div class="quiz-question">1. What drives you most?</div>
                <div class="quiz-options">
                    <div class="option-btn" onclick="selectOption(1, 'money')">Closing Deals & Making Money <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(1, 'people')">Leading People & Teams <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(1, 'product')">Building Tech & Products <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(1, 'puzzle')">Solving Complex Problems <span>‚Üí</span></div>
                </div>
            </div>
        </div>

        <div id="quizQ2" style="display:none;">
            <div class="quiz-card">
                <div class="quiz-question">2. What is your strongest skill?</div>
                <div class="quiz-options">
                    <div class="option-btn" onclick="selectOption(2, 'talk')">Persuasion & Storytelling <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(2, 'org')">Organization & Process <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(2, 'code')">Technical Deep Dives <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(2, 'strat')">Strategy & Big Picture <span>‚Üí</span></div>
                </div>
            </div>
        </div>

        <div id="quizQ3" style="display:none;">
            <div class="quiz-card">
                <div class="quiz-question">3. Clearance Status?</div>
                <div class="quiz-options">
                    <div class="option-btn" onclick="selectOption(3, 'none')">None / Public Trust <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(3, 'secret')">Secret <span>‚Üí</span></div>
                    <div class="option-btn" onclick="selectOption(3, 'ts')">Top Secret / SCI <span>‚Üí</span></div>
                </div>
            </div>
        </div>

        <div id="archetypeResult" style="display:none;">
            <div class="archetype-card">
                <div class="arch-header">
                    <span class="arch-icon" id="archIcon">ü¶Å</span>
                    <span class="arch-name" id="archName">The Rainmaker</span>
                </div>
                <div class="arch-body">
                    <p class="arch-desc" id="archDesc">You thrive on relationships and closing deals. In the DIB, this means Capture Management or Federal Sales.</p>
                    
                    <div class="label">Recommended Job Feeds</div>
                    <div id="jobLinks"></div>
                    
                    <button class="btn-main" onclick="switchTab('analyzer')" style="margin-top:24px; background:white; color:var(--ink); border:2px solid var(--ink);">
                        <span>Have a resume? Check Fit</span>
                        <span>‚Üí</span>
                    </button>
                    
                    <div style="margin-top: 16px;">
                        <button class="btn-secondary" onclick="resetQuiz()">Retake Quiz</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="viewAnalyzer" class="view-container">
        <div class="hero-title">Job Fit Analyzer</div>
        <div class="hero-sub">Deep dive comparison of your resume vs. a specific JD.</div>

        <div class="form-group">
            <span class="label">Job Description</span>
            <textarea id="jdText" class="chunky-input" placeholder="Paste JD or URL..."></textarea>
        </div>
        <div class="form-group">
            <span class="label">Resume</span>
            <textarea id="resumeText" class="chunky-input" placeholder="Paste resume..."></textarea>
        </div>
        <button class="btn-main" onclick="runAnalysis()">
            <span>ANALYZE MATCH</span>
            <span>‚Üí</span>
        </button>
        
        <div id="analysisOutput" style="margin-top:24px; display:none;">
            <div class="quiz-card" style="background:var(--pale-blue);">
                <div class="label">Match Score</div>
                <div style="font-size:56px; font-weight:700; font-family:'Space Mono'; line-height:1;" id="scoreVal">--</div>
                <div id="scoreMsg" style="font-size:13px; margin-top:12px; line-height:1.5;"></div>
            </div>
        </div>
    </div>

    <div class="fab-chat" onclick="toggleChat()">
        <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>
    </div>

    <div class="chat-overlay" id="chatOverlay">
        <div class="chat-header">
            <span class="mono" style="font-weight:700;">Arti // Coach</span>
            <span style="cursor:pointer; font-size:20px;" onclick="toggleChat()">√ó</span>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="msg arti">Hi! Use me to prep for interviews, negotiate salary, or fix your resume bullets.</div>
        </div>
        <div class="chat-input-row">
            <input type="text" id="chatInput" class="chat-input" placeholder="Ask expert advice..." onkeydown="if(event.key==='Enter') sendChat()">
            <button style="background:var(--ink); color:white; border:none; border-radius:4px; padding:0 12px; font-weight:bold; cursor:pointer;" onclick="sendChat()">></button>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('pathfinder')" id="tab-pathfinder">Pathfinder</div>
        <div class="nav-item" onclick="switchTab('analyzer')" id="tab-analyzer">Fit Analyzer</div>
    </nav>
</div>

<script>
const API_ENDPOINT = 'https://76unm1rlj0.execute-api.us-east-1.amazonaws.com/default/grumpy2';
let quizState = { q1: null, q2: null, q3: null };
let appState = { analysis: null, chatHistory: [] };

function switchTab(tab) {
    document.querySelectorAll('.view-container').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
    document.getElementById(`view${tab.charAt(0).toUpperCase() + tab.slice(1)}`).classList.add('active');
    document.getElementById(`tab-${tab}`).classList.add('active');
}

// PATHFINDER LOGIC
function selectOption(qIndex, value) {
    quizState['q' + qIndex] = value;
    if (qIndex === 1) {
        document.getElementById('quizIntro').style.display = 'none';
        document.getElementById('quizQ2').style.display = 'block';
    } else if (qIndex === 2) {
        document.getElementById('quizQ2').style.display = 'none';
        document.getElementById('quizQ3').style.display = 'block';
    } else if (qIndex === 3) {
        document.getElementById('quizQ3').style.display = 'none';
        calculateArchetype();
    }
}

function calculateArchetype() {
    const { q1, q2, q3 } = quizState;
    let title = "The Generalist";
    let icon = "üõ°Ô∏è";
    let desc = "You have broad skills useful across the DIB.";
    let queries = ["Program Analyst", "Operations Manager"];

    if (q1 === 'money' || q2 === 'talk') {
        title = "The Rainmaker";
        icon = "ü¶Å";
        desc = "You belong in **Growth**. Look for roles like 'Capture Manager', 'Federal Sales Director', or 'Business Development'.";
        queries = ["Capture Manager", "Federal Sales", "Business Development"];
    } else if (q1 === 'people' && q2 === 'org') {
        title = "The Commander";
        icon = "ü¶Ö";
        desc = "You are a natural **Program Manager**. Look for 'Program Manager', 'Project Lead', or 'Chief of Staff' roles.";
        queries = ["Program Manager", "Project Manager", "Site Lead"];
    } else if (q1 === 'product' || q2 === 'code') {
        title = "The Builder";
        icon = "‚ö°";
        desc = "You belong in **Technical Delivery**. Look for 'Solutions Architect', 'Product Manager', or 'DevSecOps' roles.";
        queries = ["Solutions Architect", "Product Manager", "Systems Engineer"];
    } else if (q1 === 'puzzle' || q2 === 'strat') {
        title = "The Strategist";
        icon = "üß†";
        desc = "You belong in **Operations & Strategy**. Look for 'Strategy Consultant', 'Operations Director', or 'Analyst' roles.";
        queries = ["Strategy Consultant", "Operations Manager", "Intelligence Analyst"];
    }

    document.getElementById('archName').textContent = title;
    document.getElementById('archIcon').textContent = icon;
    document.getElementById('archDesc').innerHTML = desc;
    
    const container = document.getElementById('jobLinks');
    container.innerHTML = '';
    
    queries.forEach(q => {
        const liUrl = `https://www.linkedin.com/jobs/search/?keywords=${encodeURIComponent(q)}`;
        const cjUrl = `https://www.clearancejobs.com/jobs?keywords=${encodeURIComponent(q)}`;
        
        container.innerHTML += `
            <a href="${liUrl}" target="_blank" class="job-link-btn">
                <span>LinkedIn: ${q}</span>
                <span>‚Üó</span>
            </a>
            ${q3 !== 'none' ? `<a href="${cjUrl}" target="_blank" class="job-link-btn" style="border-color:#003366; color:#003366; background:#f0f4f8;">
                <span>ClearanceJobs: ${q}</span>
                <span>‚Üó</span>
            </a>` : ''}
        `;
    });

    document.getElementById('archetypeResult').style.display = 'block';
}

function resetQuiz() {
    quizState = { q1: null, q2: null, q3: null };
    document.getElementById('archetypeResult').style.display = 'none';
    document.getElementById('quizIntro').style.display = 'block';
}

// ANALYZER LOGIC
function runAnalysis() {
    const r = document.getElementById('resumeText').value;
    const j = document.getElementById('jdText').value;
    if(!r || !j) return alert("Please fill both fields");

    const btn = document.querySelector('#viewAnalyzer .btn-main');
    const oldText = btn.innerHTML;
    btn.innerHTML = "ANALYZING...";
    btn.disabled = true;
    
    fetch(API_ENDPOINT, {
        method: 'POST',
        body: JSON.stringify({ request_type: 'resume_match', job_description: j, resume_text: r })
    })
    .then(r => r.json())
    .then(data => {
        appState.analysis = data;
        document.getElementById('analysisOutput').style.display = 'block';
        document.getElementById('scoreVal').textContent = data.score + '%';
        document.getElementById('scoreMsg').textContent = data.verdict;
        addMessage('arti', `Analysis done. Score: **${data.score}%**. I can now help you draft emails or prep for interviews for this role.`);
    })
    .finally(() => {
        btn.innerHTML = oldText;
        btn.disabled = false;
    });
}

// CHAT LOGIC
function toggleChat() { document.getElementById('chatOverlay').classList.toggle('open'); }

function addMessage(role, text) {
    const div = document.createElement('div');
    div.className = `msg ${role}`;
    div.innerHTML = text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
    document.getElementById('chatMessages').appendChild(div);
    document.getElementById('chatMessages').scrollTop = 9999;
}

function sendChat() {
    const input = document.getElementById('chatInput');
    const text = input.value.trim();
    if(!text) return;
    
    input.value = '';
    addMessage('user', text);
    addMessage('arti', 'Thinking...');
    
    fetch(API_ENDPOINT, {
        method: 'POST',
        body: JSON.stringify({
            request_type: 'ask_expert',
            question: text,
            job_description: document.getElementById('jdText').value,
            resume_text: document.getElementById('resumeText').value,
            analysis_data: appState.analysis,
            chat_history: appState.chatHistory
        })
    })
    .then(r => r.json())
    .then(data => {
        document.querySelector('.msg.arti:last-child').innerHTML = data.response.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
        appState.chatHistory.push({role:'user',content:text},{role:'assistant',content:data.response});
    });
}
</script>
</body>
</html>